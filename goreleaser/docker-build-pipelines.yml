dist: /tmp/pachyderm/release/docker-build-pipeline

before:
  hooks:
    - docker login

# Goreleaser needs a build step, so building a dummy binary.
# Hence the name `notusedbuild`, because its not used in any
# step.
builds:
  -
    id: notusedbuild
    dir: etc/worker
    main: init.go
    binary: notusedbuild
    goos:
      - linux
    goarch:
      - amd64

archives:
  - format: binary

checksum:
  disable: true

changelog:
  skip: true

release:
  disable: true

dockers:
  -
    image_templates:
      - pachyderm/go-build:{{.Env.VERSION}}
    skip_push: false
    dockerfile: etc/pipeline-build/go/Dockerfile
    extra_files:
      - etc/pipeline-build/go
  -
    image_templates:
      - pachyderm/python-build:{{.Env.VERSION}}
    skip_push: false
    dockerfile: etc/pipeline-build/python/Dockerfile
    extra_files:
      - etc/pipeline-build/python
