dist: trusty
sudo: required
services:
- docker
language: go
go:
- 1.6
branches:
  except:
    - /^v[0-9]/
before_install:
- echo 'DOCKER_OPTS="-H unix:///var/run/docker.sock -s devicemapper"' | sudo tee /etc/default/docker
  > /dev/null
- sudo apt-get install -qq pkg-config fuse
- sudo modprobe fuse
- sudo chmod 666 /dev/fuse
- sudo cp etc/build/fuse.conf /etc/fuse.conf
- sudo chown root:$USER /etc/fuse.conf
before_script:
- wget https://storage.googleapis.com/kubernetes-release/release/v1.2.0/bin/linux/amd64/kubectl
- chmod +x kubectl
- sudo mv kubectl /usr/local/bin/
- make launch-kube
- kubectl get all
- docker version
script:
- make launch-rethinkdb
# Do the fuse tests separately ... otherwise they seem to take a while and make CI time out
- travis_wait go test ./src/server/pfs/fuse -run=Test.*RF\$
- go test $(go list ./src/server/pfs/... | grep -v '/src/server/pfs/fuse') -run=Test.*RF\$
- go test -v ./src/server -run=Test.*RF\$
notifications:
  slack: pachyderm:qmSCZSX1Q2yWxc6DjNZZFLGd
