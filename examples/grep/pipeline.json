{
  "pipeline": {
    "name": "split"
  },
  "transform": {
    "cmd": [ "sh" ],
    "stdin": [
        "grep -r apple /pfs/data >/pfs/out/apple",
        "grep -r banana /pfs/data >/pfs/out/banana",
        "grep -r orange /pfs/data >/pfs/out/orange"
    ]
  },
  "shards": "1",
  "inputs": [
    {
      "repo": {
        "name": "data"
      }
    }
  ]
}
{
  "pipeline": {
    "name": "sum"
  },
  "transform": {
    "cmd": [ "sh" ],
    "stdin": [
        "cut -f 2 /pfs/grep/apple | awk '{s+=$1} END {print s}' >/pfs/out/apple",
        "cut -f 2 /pfs/grep/banana | awk '{s+=$1} END {print s}' >/pfs/out/banana",
        "cut -f 2 /pfs/grep/orange | awk '{s+=$1} END {print s}' >/pfs/out/orange"
    ]
  },
  "shards": "1",
  "inputs": [
    {
      "repo": {
        "name": "split"
      },
	  "reduce": true
    }
  ]
}
