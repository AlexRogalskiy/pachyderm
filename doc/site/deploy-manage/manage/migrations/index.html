<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Pachyderm Documention"><link href=https://docs.pachyderm.com/deploy-manage/manage/migrations/ rel=canonical><meta name=author content="Pachyderm Team"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.0"><title>Migrate to a Major Version - Pachyderm Documentation</title><link rel=stylesheet href=../../../assets/stylesheets/application.87b3805a.css><script src=../../../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css><link rel=stylesheet href=../../../assets/stylesheets/extra.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "None", "{'autosite_name': 'Pachyderm Documentation'}")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#migration tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://docs.pachyderm.com title="Pachyderm Documentation" class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Pachyderm Documentation </span> <span class=md-header-nav__topic> Migrate to a Major Version </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/pachyderm/pachyderm title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> pachyderm/pachyderm </div> </a> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <div class=mdl-selectfield> <select class=mdl-selectfield__select onchange="let pathParts = window.location.pathname.split('/'); pathParts[1] = this.value; window.location.pathname = pathParts.join('/')"> <option style selected value>latest</option> </select> </div> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. title=Home class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../getting_started/local_installation/ title="Getting Started" class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../../concepts/data-concepts/ title=Concepts class=md-tabs__link> Concepts </a> </li> <li class=md-tabs__item> <a href=../../../how-tos/individual-developer-workflow/ title=How-Tos class=md-tabs__link> How-Tos </a> </li> <li class=md-tabs__item> <a href=../../deploy/ title="Deploy and Manage" class=md-tabs__link> Deploy and Manage </a> </li> <li class=md-tabs__item> <a href=../../../reference/pipeline_spec/ title=Reference class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../../enterprise/overview/ title=Enterprise class=md-tabs__link> Enterprise </a> </li> <li class=md-tabs__item> <a href=../../../troubleshooting/general_troubleshooting/ title=Troubleshooting class=md-tabs__link> Troubleshooting </a> </li> </ul> </div> </nav> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://docs.pachyderm.com title="Pachyderm Documentation" class="md-nav__button md-logo"> <i class=md-icon></i> </a> Pachyderm Documentation </label> <div class=md-nav__source> <a href=https://github.com/pachyderm/pachyderm title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> pachyderm/pachyderm </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title=Welcome class=md-nav__link> Welcome </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1-2 type=checkbox id=nav-1-2> <label class=md-nav__link for=nav-1-2> Contributing </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-1-2> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../contributing/setup/ title="Setup for Contributors" class=md-nav__link> Setup for Contributors </a> </li> <li class=md-nav__item> <a href=../../../contributing/gcloud-setup/ title="Gcloud Cluster Setup" class=md-nav__link> Gcloud Cluster Setup </a> </li> <li class=md-nav__item> <a href=../../../contributing/repo-layout/ title="Repo Layout" class=md-nav__link> Repo Layout </a> </li> <li class=md-nav__item> <a href=../../../contributing/coding-conventions/ title="Coding Conventions" class=md-nav__link> Coding Conventions </a> </li> <li class=md-nav__item> <a href=../../../contributing/docs-style-guide/ title="Documentation Style Guide" class=md-nav__link> Documentation Style Guide </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Getting Started </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../getting_started/local_installation/ title="Local Installation" class=md-nav__link> Local Installation </a> </li> <li class=md-nav__item> <a href=../../../getting_started/beginner_tutorial/ title="Beginner Tutorial" class=md-nav__link> Beginner Tutorial </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> Versioned Data Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-1> Versioned Data Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../concepts/data-concepts/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../concepts/data-concepts/repo/ title=Repository class=md-nav__link> Repository </a> </li> <li class=md-nav__item> <a href=../../../concepts/data-concepts/commit/ title=Commit class=md-nav__link> Commit </a> </li> <li class=md-nav__item> <a href=../../../concepts/data-concepts/branch/ title=Branch class=md-nav__link> Branch </a> </li> <li class=md-nav__item> <a href=../../../concepts/data-concepts/file/ title=File class=md-nav__link> File </a> </li> <li class=md-nav__item> <a href=../../../concepts/data-concepts/provenance/ title=Provenance class=md-nav__link> Provenance </a> </li> <li class=md-nav__item> <a href=../../../concepts/data-concepts/history/ title=History class=md-nav__link> History </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Pipeline Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-2> Pipeline Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/ title=Overview class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2-2 type=checkbox id=nav-3-2-2> <label class=md-nav__link for=nav-3-2-2> Pipeline </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-3-2-2> Pipeline </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/pipeline/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/pipeline/cron/ title=Cron class=md-nav__link> Cron </a> </li> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/pipeline/service/ title=Service class=md-nav__link> Service </a> </li> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/pipeline/spout/ title=Spout class=md-nav__link> Spout </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/job/ title=Job class=md-nav__link> Job </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-2-4 type=checkbox id=nav-3-2-4> <label class=md-nav__link for=nav-3-2-4> Datum </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-3-2-4> Datum </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/datum/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/datum/glob-pattern/ title="Glob Patterns" class=md-nav__link> Glob Patterns </a> </li> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/datum/relationship-between-datums/ title="Datum Processing" class=md-nav__link> Datum Processing </a> </li> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/datum/cross-union/ title="Cross and Union Inputs" class=md-nav__link> Cross and Union Inputs </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> Advanced Concepts </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-3> Advanced Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../concepts/pipeline-concepts/distributed_computing/ title="Distributed Computing" class=md-nav__link> Distributed Computing </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> How-Tos </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> How-Tos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../how-tos/individual-developer-workflow/ title="Individual Developer Workflow" class=md-nav__link> Individual Developer Workflow </a> </li> <li class=md-nav__item> <a href=../../../how-tos/team-developer-workflow/ title="Team Developer Workflow" class=md-nav__link> Team Developer Workflow </a> </li> <li class=md-nav__item> <a href=../../../how-tos/load-data-into-pachyderm/ title="Load Your Data Into Pachyderm" class=md-nav__link> Load Your Data Into Pachyderm </a> </li> <li class=md-nav__item> <a href=../../../how-tos/export-data-out-pachyderm/ title="Export Your Data From Pachyderm" class=md-nav__link> Export Your Data From Pachyderm </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-5 type=checkbox id=nav-4-5> <label class=md-nav__link for=nav-4-5> Split Data </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-5> Split Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../how-tos/splitting-data/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../how-tos/splitting-data/splitting/ title="Splitting Data for Distributed Processing" class=md-nav__link> Splitting Data for Distributed Processing </a> </li> <li class=md-nav__item> <a href=../../../how-tos/splitting-data/adjusting_data_processing_w_split/ title="Adjusting Data Processing by Splitting Data" class=md-nav__link> Adjusting Data Processing by Splitting Data </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../how-tos/combining/ title="Combine, Merge, and Join Data" class=md-nav__link> Combine, Merge, and Join Data </a> </li> <li class=md-nav__item> <a href=../../../how-tos/create-ml-workflow/ title="Create a Machine Learning Workflow" class=md-nav__link> Create a Machine Learning Workflow </a> </li> <li class=md-nav__item> <a href=../../../how-tos/run_pipeline/ title="Run a Pipeline on a Specific Commit" class=md-nav__link> Run a Pipeline on a Specific Commit </a> </li> <li class=md-nav__item> <a href=../../../how-tos/updating_pipelines/ title="Update a Pipeline" class=md-nav__link> Update a Pipeline </a> </li> <li class=md-nav__item> <a href=../../../how-tos/time_windows/ title="Processing Time-Windowed Data" class=md-nav__link> Processing Time-Windowed Data </a> </li> <li class=md-nav__item> <a href=../../../how-tos/removing_data_from_pachyderm/ title="Delete Data" class=md-nav__link> Delete Data </a> </li> <li class=md-nav__item> <a href=../../../how-tos/distributed_computing/ title="Configure Distributed Computing" class=md-nav__link> Configure Distributed Computing </a> </li> <li class=md-nav__item> <a href=../../../how-tos/deferred_processing/ title="Deferred Processing of Data" class=md-nav__link> Deferred Processing of Data </a> </li> <li class=md-nav__item> <a href=../../../how-tos/ingressing_from_diff_cloud/ title="Ingress and Egress Data from an External Object Store" class=md-nav__link> Ingress and Egress Data from an External Object Store </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5 checked> <label class=md-nav__link for=nav-5> Deploy and Manage </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Deploy and Manage </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1 type=checkbox id=nav-5-1> <label class=md-nav__link for=nav-5-1> Deploy Pachyderm </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-1> Deploy Pachyderm </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deploy/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../pachub/pachub_getting_started/ title="Getting Started with Pachyderm Hub" class=md-nav__link> Getting Started with Pachyderm Hub </a> </li> <li class=md-nav__item> <a href=../../deploy/google_cloud_platform/ title="Deploy on GKE" class=md-nav__link> Deploy on GKE </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1-4 type=checkbox id=nav-5-1-4> <label class=md-nav__link for=nav-5-1-4> Deploy on AWS </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-1-4> Deploy on AWS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deploy/amazon_web_services/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../deploy/amazon_web_services/deploy-eks/ title="Deploy Pachyderm on Amazon EKS" class=md-nav__link> Deploy Pachyderm on Amazon EKS </a> </li> <li class=md-nav__item> <a href=../../deploy/amazon_web_services/aws-deploy-kubernetes-kops/ title="Deploy Kubernetes with kops" class=md-nav__link> Deploy Kubernetes with kops </a> </li> <li class=md-nav__item> <a href=../../deploy/amazon_web_services/aws-deploy-pachyderm/ title="Deploy Pachyderm on AWS" class=md-nav__link> Deploy Pachyderm on AWS </a> </li> <li class=md-nav__item> <a href=../../deploy/amazon_web_services/aws_cloudfront/ title="Deploy a Pachyderm Cluster with CloudFront" class=md-nav__link> Deploy a Pachyderm Cluster with CloudFront </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../deploy/azure/ title="Deploy on Azure" class=md-nav__link> Deploy on Azure </a> </li> <li class=md-nav__item> <a href=../../deploy/openshift/ title="Deploy on OpenShift" class=md-nav__link> Deploy on OpenShift </a> </li> <li class=md-nav__item> <a href=../../deploy/on_premises/ title="Deploy On-Premises" class=md-nav__link> Deploy On-Premises </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1-8 type=checkbox id=nav-5-1-8> <label class=md-nav__link for=nav-5-1-8> Create a Custom Deployment </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-1-8> Create a Custom Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deploy/deploy_custom/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../deploy/deploy_custom/deploy_custom_before_you_begin/ title="Before You Begin" class=md-nav__link> Before You Begin </a> </li> <li class=md-nav__item> <a href=../../deploy/deploy_custom/deploy_custom_pachyderm_deployment_manifest/ title="Pachyderm Deployment Manifest" class=md-nav__link> Pachyderm Deployment Manifest </a> </li> <li class=md-nav__item> <a href=../../deploy/deploy_custom/deploy_custom_configuring_persistent_disk_parameters/ title="Configuring Persistent Disk Parameters" class=md-nav__link> Configuring Persistent Disk Parameters </a> </li> <li class=md-nav__item> <a href=../../deploy/deploy_custom/deploy_custom_configuring_object_store/ title="Configuring Object Store" class=md-nav__link> Configuring Object Store </a> </li> <li class=md-nav__item> <a href=../../deploy/deploy_custom/deploy_custom_complete_example_invocation/ title="Create a Complete Configuration" class=md-nav__link> Create a Complete Configuration </a> </li> <li class=md-nav__item> <a href=../../deploy/deploy_custom/deploy_custom_additional_flags/ title="Additional flags" class=md-nav__link> Additional flags </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1-8-8 type=checkbox id=nav-5-1-8-8> <label class=md-nav__link for=nav-5-1-8-8> Other Customizations </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-1-8-8> Other Customizations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deploy/namespaces/ title="Deploy in a Custom Namespace" class=md-nav__link> Deploy in a Custom Namespace </a> </li> <li class=md-nav__item> <a href=../../deploy/non-cloud-object-stores/ title="Deploy a Custom Object Store" class=md-nav__link> Deploy a Custom Object Store </a> </li> <li class=md-nav__item> <a href=../../deploy/rbac/ title="Configure RBAC" class=md-nav__link> Configure RBAC </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../deploy/tracing/ title="Configure Tracing with Jaeger" class=md-nav__link> Configure Tracing with Jaeger </a> </li> <li class=md-nav__item> <a href=../../deploy/connect-to-cluster/ title="Connect to a Pachyderm cluster" class=md-nav__link> Connect to a Pachyderm cluster </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2 checked> <label class=md-nav__link for=nav-5-2> Manage Pachyderm </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> Manage Pachyderm </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cluster-access/ title="Manage Cluster Access" class=md-nav__link> Manage Cluster Access </a> </li> <li class=md-nav__item> <a href=../autoscaling/ title="Autoscale your Cluster" class=md-nav__link> Autoscale your Cluster </a> </li> <li class=md-nav__item> <a href=../batching_pachyderm_with_transactions/ title="Batching Pachyderm with Transactions" class=md-nav__link> Batching Pachyderm with Transactions </a> </li> <li class=md-nav__item> <a href=../backup_restore/ title="Backup and Restore" class=md-nav__link> Backup and Restore </a> </li> <li class=md-nav__item> <a href=../data_management/ title="Storage Use Optimization" class=md-nav__link> Storage Use Optimization </a> </li> <li class=md-nav__item> <a href=../gpus/ title="Use GPUs" class=md-nav__link> Use GPUs </a> </li> <li class=md-nav__item> <a href=../sharing_gpu_resources/ title="Sharing GPU Resources" class=md-nav__link> Sharing GPU Resources </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-8 type=checkbox id=nav-5-2-8 checked> <label class=md-nav__link for=nav-5-2-8> Upgrades and Migrations </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-8> Upgrades and Migrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../upgrades_migrations/ title=Overview class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Migrate to a Major Version </label> <a href=./ title="Migrate to a Major Version" class="md-nav__link md-nav__link--active"> Migrate to a Major Version </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#introduction title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#note-about-17-to-18-migrations title="Note about 1.7 to 1.8 migrations" class=md-nav__link> Note about 1.7 to 1.8 migrations </a> </li> <li class=md-nav__item> <a href=#general-migration-procedure title="General migration procedure" class=md-nav__link> General migration procedure </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#before-you-start-backups title="Before you start: backups" class=md-nav__link> Before you start: backups </a> </li> <li class=md-nav__item> <a href=#migration-steps title="Migration steps" class=md-nav__link> Migration steps </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-pause-all-pipeline-and-data-loading-operations title="1. Pause all pipeline and data loading operations" class=md-nav__link> 1. Pause all pipeline and data loading operations </a> </li> <li class=md-nav__item> <a href=#pausing-data-loading-operations title="Pausing data loading operations" class=md-nav__link> Pausing data loading operations </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-extract-a-pachyderm-backup-with-the-no-objects-flag title="2. Extract a pachyderm backup with the --no-objects flag" class=md-nav__link> 2. Extract a pachyderm backup with the --no-objects flag </a> </li> <li class=md-nav__item> <a href=#3-clone-your-object-store-bucket title="3. Clone your object store bucket" class=md-nav__link> 3. Clone your object store bucket </a> </li> <li class=md-nav__item> <a href=#4-restart-all-pipeline-and-data-loading-ops title="4. Restart all pipeline and data loading ops" class=md-nav__link> 4. Restart all pipeline and data loading ops </a> </li> <li class=md-nav__item> <a href=#5-deploy-a-1x-pachyderm-cluster-with-cloned-bucket title="5. Deploy a 1.X Pachyderm cluster with cloned bucket" class=md-nav__link> 5. Deploy a 1.X Pachyderm cluster with cloned bucket </a> </li> <li class=md-nav__item> <a href=#6-restore-the-new-1x-pachyderm-cluster-from-your-backup title="6. Restore the new 1.X Pachyderm cluster from your backup" class=md-nav__link> 6. Restore the new 1.X Pachyderm cluster from your backup </a> </li> <li class=md-nav__item> <a href=#7-load-transactional-data-from-checkpoint-into-new-cluster title="7. Load transactional data from checkpoint into new cluster" class=md-nav__link> 7. Load transactional data from checkpoint into new cluster </a> </li> <li class=md-nav__item> <a href=#8-disable-the-old-cluster title="8. Disable the old cluster" class=md-nav__link> 8. Disable the old cluster </a> </li> <li class=md-nav__item> <a href=#9-reconfigure-new-cluster-as-necessary title="9. Reconfigure new cluster as necessary" class=md-nav__link> 9. Reconfigure new cluster as necessary </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../upgrades/ title="Upgrade your Cluster" class=md-nav__link> Upgrade your Cluster </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../disable-metrics/ title="Disable Usage Metrics" class=md-nav__link> Disable Usage Metrics </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Reference </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../reference/pipeline_spec/ title="Pipeline Specification" class=md-nav__link> Pipeline Specification </a> </li> <li class=md-nav__item> <a href=../../../reference/config_spec/ title="Pachyderm Config Specification" class=md-nav__link> Pachyderm Config Specification </a> </li> <li class=md-nav__item> <a href=../../../reference/clients/ title="Pachyderm Language Clients" class=md-nav__link> Pachyderm Language Clients </a> </li> <li class=md-nav__item> <a href=../../../reference/s3gateway_api/ title="S3 Gateway API Reference" class=md-nav__link> S3 Gateway API Reference </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-5 type=checkbox id=nav-6-5> <label class=md-nav__link for=nav-6-5> Pachctl Reference </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-5> Pachctl Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl/ title=Pachctl class=md-nav__link> Pachctl </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth/ title="Pachctl auth" class=md-nav__link> Pachctl auth </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_activate/ title="Pachctl auth activate" class=md-nav__link> Pachctl auth activate </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_check/ title="Pachctl auth check" class=md-nav__link> Pachctl auth check </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_deactivate/ title="Pachctl auth deactivate" class=md-nav__link> Pachctl auth deactivate </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_get-auth-token/ title="Pachctl auth get auth token" class=md-nav__link> Pachctl auth get auth token </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_get-config/ title="Pachctl auth get config" class=md-nav__link> Pachctl auth get config </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_get-otp/ title="Pachctl auth get otp" class=md-nav__link> Pachctl auth get otp </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_get/ title="Pachctl auth get" class=md-nav__link> Pachctl auth get </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_list-admins/ title="Pachctl auth list admins" class=md-nav__link> Pachctl auth list admins </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_login/ title="Pachctl auth login" class=md-nav__link> Pachctl auth login </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_logout/ title="Pachctl auth logout" class=md-nav__link> Pachctl auth logout </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_modify-admins/ title="Pachctl auth modify admins" class=md-nav__link> Pachctl auth modify admins </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_set-config/ title="Pachctl auth set config" class=md-nav__link> Pachctl auth set config </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_set/ title="Pachctl auth set" class=md-nav__link> Pachctl auth set </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_use-auth-token/ title="Pachctl auth use auth token" class=md-nav__link> Pachctl auth use auth token </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_auth_whoami/ title="Pachctl auth whoami" class=md-nav__link> Pachctl auth whoami </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_completion/ title="Pachctl completion" class=md-nav__link> Pachctl completion </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config/ title="Pachctl config" class=md-nav__link> Pachctl config </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_delete/ title="Pachctl config delete" class=md-nav__link> Pachctl config delete </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_delete_context/ title="Pachctl config delete context" class=md-nav__link> Pachctl config delete context </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_get/ title="Pachctl config get" class=md-nav__link> Pachctl config get </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_get_active-context/ title="Pachctl config get active context" class=md-nav__link> Pachctl config get active context </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_get_context/ title="Pachctl config get context" class=md-nav__link> Pachctl config get context </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_get_metrics/ title="Pachctl config get metrics" class=md-nav__link> Pachctl config get metrics </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_list/ title="Pachctl config list" class=md-nav__link> Pachctl config list </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_list_context/ title="Pachctl config list context" class=md-nav__link> Pachctl config list context </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_set/ title="Pachctl config set" class=md-nav__link> Pachctl config set </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_set_active-context/ title="Pachctl config set active context" class=md-nav__link> Pachctl config set active context </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_set_context/ title="Pachctl config set context" class=md-nav__link> Pachctl config set context </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_set_metrics/ title="Pachctl config set metrics" class=md-nav__link> Pachctl config set metrics </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_update/ title="Pachctl config update" class=md-nav__link> Pachctl config update </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_config_update_context/ title="Pachctl config update context" class=md-nav__link> Pachctl config update context </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_copy/ title="Pachctl copy" class=md-nav__link> Pachctl copy </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_copy_file/ title="Pachctl copy file" class=md-nav__link> Pachctl copy file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_create/ title="Pachctl create" class=md-nav__link> Pachctl create </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_create_branch/ title="Pachctl create branch" class=md-nav__link> Pachctl create branch </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_create_pipeline/ title="Pachctl create pipeline" class=md-nav__link> Pachctl create pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_create_repo/ title="Pachctl create repo" class=md-nav__link> Pachctl create repo </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_debug/ title="Pachctl debug" class=md-nav__link> Pachctl debug </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_debug_binary/ title="Pachctl debug binary" class=md-nav__link> Pachctl debug binary </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_debug_dump/ title="Pachctl debug dump" class=md-nav__link> Pachctl debug dump </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_debug_pprof/ title="Pachctl debug pprof" class=md-nav__link> Pachctl debug pprof </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_debug_profile/ title="Pachctl debug profile" class=md-nav__link> Pachctl debug profile </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete/ title="Pachctl delete" class=md-nav__link> Pachctl delete </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_all/ title="Pachctl delete all" class=md-nav__link> Pachctl delete all </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_branch/ title="Pachctl delete branch" class=md-nav__link> Pachctl delete branch </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_commit/ title="Pachctl delete commit" class=md-nav__link> Pachctl delete commit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_file/ title="Pachctl delete file" class=md-nav__link> Pachctl delete file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_job/ title="Pachctl delete job" class=md-nav__link> Pachctl delete job </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_pipeline/ title="Pachctl delete pipeline" class=md-nav__link> Pachctl delete pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_repo/ title="Pachctl delete repo" class=md-nav__link> Pachctl delete repo </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_delete_transaction/ title="Pachctl delete transaction" class=md-nav__link> Pachctl delete transaction </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy/ title="Pachctl deploy" class=md-nav__link> Pachctl deploy </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_amazon/ title="Pachctl deploy amazon" class=md-nav__link> Pachctl deploy amazon </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_custom/ title="Pachctl deploy custom" class=md-nav__link> Pachctl deploy custom </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_export-images/ title="Pachctl deploy export images" class=md-nav__link> Pachctl deploy export images </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_google/ title="Pachctl deploy google" class=md-nav__link> Pachctl deploy google </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_import-images/ title="Pachctl deploy import images" class=md-nav__link> Pachctl deploy import images </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_list-images/ title="Pachctl deploy list images" class=md-nav__link> Pachctl deploy list images </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_local/ title="Pachctl deploy local" class=md-nav__link> Pachctl deploy local </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_microsoft/ title="Pachctl deploy microsoft" class=md-nav__link> Pachctl deploy microsoft </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_storage/ title="Pachctl deploy storage" class=md-nav__link> Pachctl deploy storage </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_storage_amazon/ title="Pachctl deploy storage amazon" class=md-nav__link> Pachctl deploy storage amazon </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_storage_google/ title="Pachctl deploy storage google" class=md-nav__link> Pachctl deploy storage google </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_deploy_storage_microsoft/ title="Pachctl deploy storage microsoft" class=md-nav__link> Pachctl deploy storage microsoft </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_diff/ title="Pachctl diff" class=md-nav__link> Pachctl diff </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_diff_file/ title="Pachctl diff file" class=md-nav__link> Pachctl diff file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_edit/ title="Pachctl edit" class=md-nav__link> Pachctl edit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_edit_pipeline/ title="Pachctl edit pipeline" class=md-nav__link> Pachctl edit pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_enterprise/ title="Pachctl enterprise" class=md-nav__link> Pachctl enterprise </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_enterprise_activate/ title="Pachctl enterprise activate" class=md-nav__link> Pachctl enterprise activate </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_enterprise_get-state/ title="Pachctl enterprise get state" class=md-nav__link> Pachctl enterprise get state </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_extract/ title="Pachctl extract" class=md-nav__link> Pachctl extract </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_extract_pipeline/ title="Pachctl extract pipeline" class=md-nav__link> Pachctl extract pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_finish/ title="Pachctl finish" class=md-nav__link> Pachctl finish </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_finish_commit/ title="Pachctl finish commit" class=md-nav__link> Pachctl finish commit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_finish_transaction/ title="Pachctl finish transaction" class=md-nav__link> Pachctl finish transaction </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_flush/ title="Pachctl flush" class=md-nav__link> Pachctl flush </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_flush_commit/ title="Pachctl flush commit" class=md-nav__link> Pachctl flush commit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_flush_job/ title="Pachctl flush job" class=md-nav__link> Pachctl flush job </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_fsck/ title="Pachctl fsck" class=md-nav__link> Pachctl fsck </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_garbage-collect/ title="Pachctl garbage collect" class=md-nav__link> Pachctl garbage collect </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_get/ title="Pachctl get" class=md-nav__link> Pachctl get </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_get_file/ title="Pachctl get file" class=md-nav__link> Pachctl get file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_get_object/ title="Pachctl get object" class=md-nav__link> Pachctl get object </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_get_tag/ title="Pachctl get tag" class=md-nav__link> Pachctl get tag </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_glob/ title="Pachctl glob" class=md-nav__link> Pachctl glob </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_glob_file/ title="Pachctl glob file" class=md-nav__link> Pachctl glob file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect/ title="Pachctl inspect" class=md-nav__link> Pachctl inspect </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_cluster/ title="Pachctl inspect cluster" class=md-nav__link> Pachctl inspect cluster </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_commit/ title="Pachctl inspect commit" class=md-nav__link> Pachctl inspect commit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_datum/ title="Pachctl inspect datum" class=md-nav__link> Pachctl inspect datum </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_file/ title="Pachctl inspect file" class=md-nav__link> Pachctl inspect file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_job/ title="Pachctl inspect job" class=md-nav__link> Pachctl inspect job </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_pipeline/ title="Pachctl inspect pipeline" class=md-nav__link> Pachctl inspect pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_repo/ title="Pachctl inspect repo" class=md-nav__link> Pachctl inspect repo </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_inspect_transaction/ title="Pachctl inspect transaction" class=md-nav__link> Pachctl inspect transaction </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list/ title="Pachctl list" class=md-nav__link> Pachctl list </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_branch/ title="Pachctl list branch" class=md-nav__link> Pachctl list branch </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_commit/ title="Pachctl list commit" class=md-nav__link> Pachctl list commit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_datum/ title="Pachctl list datum" class=md-nav__link> Pachctl list datum </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_file/ title="Pachctl list file" class=md-nav__link> Pachctl list file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_job/ title="Pachctl list job" class=md-nav__link> Pachctl list job </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_pipeline/ title="Pachctl list pipeline" class=md-nav__link> Pachctl list pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_repo/ title="Pachctl list repo" class=md-nav__link> Pachctl list repo </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_list_transaction/ title="Pachctl list transaction" class=md-nav__link> Pachctl list transaction </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_logs/ title="Pachctl logs" class=md-nav__link> Pachctl logs </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_mount/ title="Pachctl mount" class=md-nav__link> Pachctl mount </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_port-forward/ title="Pachctl port forward" class=md-nav__link> Pachctl port forward </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_put/ title="Pachctl put" class=md-nav__link> Pachctl put </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_put_file/ title="Pachctl put file" class=md-nav__link> Pachctl put file </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_restart/ title="Pachctl restart" class=md-nav__link> Pachctl restart </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_restart_datum/ title="Pachctl restart datum" class=md-nav__link> Pachctl restart datum </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_restore/ title="Pachctl restore" class=md-nav__link> Pachctl restore </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_resume/ title="Pachctl resume" class=md-nav__link> Pachctl resume </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_resume_transaction/ title="Pachctl resume transaction" class=md-nav__link> Pachctl resume transaction </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_run/ title="Pachctl run" class=md-nav__link> Pachctl run </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_run_pipeline/ title="Pachctl run pipeline" class=md-nav__link> Pachctl run pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_start/ title="Pachctl start" class=md-nav__link> Pachctl start </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_start_commit/ title="Pachctl start commit" class=md-nav__link> Pachctl start commit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_start_pipeline/ title="Pachctl start pipeline" class=md-nav__link> Pachctl start pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_start_transaction/ title="Pachctl start transaction" class=md-nav__link> Pachctl start transaction </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_stop/ title="Pachctl stop" class=md-nav__link> Pachctl stop </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_stop_job/ title="Pachctl stop job" class=md-nav__link> Pachctl stop job </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_stop_pipeline/ title="Pachctl stop pipeline" class=md-nav__link> Pachctl stop pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_stop_transaction/ title="Pachctl stop transaction" class=md-nav__link> Pachctl stop transaction </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_subscribe/ title="Pachctl subscribe" class=md-nav__link> Pachctl subscribe </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_subscribe_commit/ title="Pachctl subscribe commit" class=md-nav__link> Pachctl subscribe commit </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_undeploy/ title="Pachctl undeploy" class=md-nav__link> Pachctl undeploy </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_unmount/ title="Pachctl unmount" class=md-nav__link> Pachctl unmount </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_update-dash/ title="Pachctl update dash" class=md-nav__link> Pachctl update dash </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_update/ title="Pachctl update" class=md-nav__link> Pachctl update </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_update_pipeline/ title="Pachctl update pipeline" class=md-nav__link> Pachctl update pipeline </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_update_repo/ title="Pachctl update repo" class=md-nav__link> Pachctl update repo </a> </li> <li class=md-nav__item> <a href=../../../reference/pachctl/pachctl_version/ title="Pachctl version" class=md-nav__link> Pachctl version </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../examples/examples/ title=Examples class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Enterprise </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Enterprise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../enterprise/overview/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../enterprise/deployment/ title="Deploy Enterprise Edition" class=md-nav__link> Deploy Enterprise Edition </a> </li> <li class=md-nav__item> <a href=../../../enterprise/auth/auth/ title="Configure Access Controls" class=md-nav__link> Configure Access Controls </a> </li> <li class=md-nav__item> <a href=../../../enterprise/stats/ title="Advanced Statistics" class=md-nav__link> Advanced Statistics </a> </li> <li class=md-nav__item> <a href=../../../enterprise/s3gateway/ title="Using the S3 Gateway" class=md-nav__link> Using the S3 Gateway </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7-6 type=checkbox id=nav-7-6> <label class=md-nav__link for=nav-7-6> Configure Pachyderm with an Access Management Provider </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-7-6> Configure Pachyderm with an Access Management Provider </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../enterprise/saml/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../enterprise/saml_setup/ title="Configure SAML" class=md-nav__link> Configure SAML </a> </li> <li class=md-nav__item> <a href=../../../enterprise/saml_usage/ title="Use SAML" class=md-nav__link> Use SAML </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Troubleshooting </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-8> Troubleshooting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../troubleshooting/general_troubleshooting/ title="General Troubleshooting" class=md-nav__link> General Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../../troubleshooting/deploy_troubleshooting/ title="Deployment Troubleshootin" class=md-nav__link> Deployment Troubleshootin </a> </li> <li class=md-nav__item> <a href=../../../troubleshooting/pipeline_troubleshooting/ title="Pipeline Troubleshooting" class=md-nav__link> Pipeline Troubleshooting </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#introduction title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#note-about-17-to-18-migrations title="Note about 1.7 to 1.8 migrations" class=md-nav__link> Note about 1.7 to 1.8 migrations </a> </li> <li class=md-nav__item> <a href=#general-migration-procedure title="General migration procedure" class=md-nav__link> General migration procedure </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#before-you-start-backups title="Before you start: backups" class=md-nav__link> Before you start: backups </a> </li> <li class=md-nav__item> <a href=#migration-steps title="Migration steps" class=md-nav__link> Migration steps </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-pause-all-pipeline-and-data-loading-operations title="1. Pause all pipeline and data loading operations" class=md-nav__link> 1. Pause all pipeline and data loading operations </a> </li> <li class=md-nav__item> <a href=#pausing-data-loading-operations title="Pausing data loading operations" class=md-nav__link> Pausing data loading operations </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-extract-a-pachyderm-backup-with-the-no-objects-flag title="2. Extract a pachyderm backup with the --no-objects flag" class=md-nav__link> 2. Extract a pachyderm backup with the --no-objects flag </a> </li> <li class=md-nav__item> <a href=#3-clone-your-object-store-bucket title="3. Clone your object store bucket" class=md-nav__link> 3. Clone your object store bucket </a> </li> <li class=md-nav__item> <a href=#4-restart-all-pipeline-and-data-loading-ops title="4. Restart all pipeline and data loading ops" class=md-nav__link> 4. Restart all pipeline and data loading ops </a> </li> <li class=md-nav__item> <a href=#5-deploy-a-1x-pachyderm-cluster-with-cloned-bucket title="5. Deploy a 1.X Pachyderm cluster with cloned bucket" class=md-nav__link> 5. Deploy a 1.X Pachyderm cluster with cloned bucket </a> </li> <li class=md-nav__item> <a href=#6-restore-the-new-1x-pachyderm-cluster-from-your-backup title="6. Restore the new 1.X Pachyderm cluster from your backup" class=md-nav__link> 6. Restore the new 1.X Pachyderm cluster from your backup </a> </li> <li class=md-nav__item> <a href=#7-load-transactional-data-from-checkpoint-into-new-cluster title="7. Load transactional data from checkpoint into new cluster" class=md-nav__link> 7. Load transactional data from checkpoint into new cluster </a> </li> <li class=md-nav__item> <a href=#8-disable-the-old-cluster title="8. Disable the old cluster" class=md-nav__link> 8. Disable the old cluster </a> </li> <li class=md-nav__item> <a href=#9-reconfigure-new-cluster-as-necessary title="9. Reconfigure new cluster as necessary" class=md-nav__link> 9. Reconfigure new cluster as necessary </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=migration>Migration<a class=headerlink href=#migration title="Permanent link">&para;</a></h1> <div class="admonition info"> <p class=admonition-title>Info</p> <p>If you need to upgrade Pachyderm from one minor version to another, such as from 1.9.4 to 1.9.5, see <a href=../upgrades/ >Upgrade Pachyderm</a>.</p> </div> <ul> <li><a href=#introduction>Introduction</a></li> <li>[Note about 1.7 to 1.8 migrations](#note-about-1-7-to-1-8-migrations]</li> <li><a href=#general-migration-procedure>General migration procedure</a><ul> <li><a href=#before-you-start-backups>Before you start: backups</a></li> <li><a href=#migration-steps>Migration steps</a><ul> <li><a href=#pause-all-pipeline-and-data-loading-operations>1. Pause all pipeline and data loading operations</a></li> <li><a href=#extract-a-pachyderm-backup-with-the-no-objects-flag>2. Extract a pachyderm backup with the --no-objects flag</a></li> <li><a href=#clone-your-object-store-bucket>3. Clone your object store bucket</a></li> <li><a href=#restart-all-pipeline-and-data-loading-ops>4. Restart all pipeline and data loading ops</a></li> <li><a href=#deploy-a-1-x-pachyderm-cluster-with-cloned-bucket>5. Deploy a 1.X Pachyderm cluster with cloned bucket</a></li> <li><a href=#restore-the-new-1-y-pachyderm-cluster-from-your-backup>6. Restore the new 1.X Pachyderm cluster from your backup</a></li> <li><a href=#load-transactional-data-from-checkpoint-into-new-cluster>7. Load transactional data from checkpoint into new cluster</a></li> <li><a href=#disable-the-old-cluster>8. Disable the old cluster</a></li> <li><a href=#reconfigure-new-cluster-as-necessary>9. Reconfigure new cluster as necessary</a></li> </ul> </li> </ul> </li> </ul> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>As new versions of Pachyderm are released, you may need to update your cluster to get access to bug fixes and new features. These updates fall into two categories, upgrades and migrations.</p> <p>An upgrade is moving between point releases within the same major release, like 1.7.2 to 1.7.3. Upgrades are typically a simple process that require little to no downtime.</p> <p>Migrations involve moving between major releases, like 1.8.6 to 1.9.0. Migration is covered in this document. </p> <p>In general, Pachyderm stores all of its state in two places: <code>etcd</code> (which in turn stores its state in one or more persistent volumes, which were created when the Pachyderm cluster was deployed) and an object store bucket (something like AWS S3, MinIO, or Azure Blob Storage).</p> <p>In a migration, the data structures stored in those locations need to be read, transformed, and rewritten, so the process involves:</p> <ol> <li>bringing up a new Pachyderm cluster adjacent to the old pachyderm cluster</li> <li>exporting the old Pachdyerm cluster's repos, pipelines, and input commits</li> <li>importing the old cluster's repos, commits, and pipelines into the new cluster.</li> </ol> <p><em>You must perform a migration to move between major releases</em>, such as 1.8.7 to 1.9.0.</p> <p>Whether you're doing an upgrade or migration, it is recommended you <a href=./backup_restore#general-backup-procedure>backup Pachyderm</a> prior. That will guarantee you can restore your cluster to its previous, good state.</p> <h2 id=note-about-17-to-18-migrations>Note about 1.7 to 1.8 migrations<a class=headerlink href=#note-about-17-to-18-migrations title="Permanent link">&para;</a></h2> <p>In Pachyderm 1.8, we rearchitected core parts of the platform to <a href=http://www.pachyderm.io/2018/11/15/performance-improvements.html>improve speed and scalability</a>. Migrating from 1.7.x to 1.8.x using the procedure below can a fairly lengthy process. If your requirements fit, it may be easier to create a new 1.8 or greater cluster and reload your latest source data into your input repositories.</p> <p>You may wish to keep your original 1.7 cluster around in a suspended state, reactivating it in case you need access to that provenance data.</p> <h2 id=general-migration-procedure>General migration procedure<a class=headerlink href=#general-migration-procedure title="Permanent link">&para;</a></h2> <h3 id=before-you-start-backups>Before you start: backups<a class=headerlink href=#before-you-start-backups title="Permanent link">&para;</a></h3> <p>Please refer to <a href=./backup_restorel#general-backup-procedure>the documentation on backing up your cluster</a>.</p> <h3 id=migration-steps>Migration steps<a class=headerlink href=#migration-steps title="Permanent link">&para;</a></h3> <h4 id=1-pause-all-pipeline-and-data-loading-operations>1. Pause all pipeline and data loading operations<a class=headerlink href=#1-pause-all-pipeline-and-data-loading-operations title="Permanent link">&para;</a></h4> <p>From the directed acyclic graphs (DAG) that define your pachyderm cluster, stop each pipeline step. You can either run a multiline shell command, shown below, or you must, for each pipeline, manually run the <code>stop pipeline</code> command.</p> <p><code>pachctl stop pipeline &lt;pipeline-name&gt;</code></p> <p>You can confirm each pipeline is paused using the <code>list pipeline</code> command</p> <p><code>pachctl list pipeline</code></p> <p>Alternatively, a useful shell script for running <code>stop pipeline</code> on all pipelines is included below. It may be necessary to install the utilities used in the script, like <code>jq</code> and <code>xargs</code>, on your system.</p> <div class=codehilite><pre><span></span>pachctl list pipeline --raw \
  | jq -r &#39;.pipeline.name&#39; \
  | xargs -P3 -n1 -I{} pachctl stop pipeline {}
</pre></div> <p>It's also a useful practice, for simple to moderately complex deployments, to keep a terminal window up showing the state of all running kubernetes pods.</p> <p><code>watch -n 5 kubectl get pods</code></p> <p>You may need to install the <code>watch</code> and <code>kubectl</code> commands on your system, and configure <code>kubectl</code> to point at the cluster that Pachyderm is running in.</p> <h4 id=pausing-data-loading-operations>Pausing data loading operations<a class=headerlink href=#pausing-data-loading-operations title="Permanent link">&para;</a></h4> <p><strong>Input repositories</strong> or <strong>input repos</strong> in Pachyderm are repositories created with the <code>pachctl create repo</code> command. They're designed to be the repos at the top of a directed acyclic graph of pipelines. Pipelines have their own output repos associated with them, and are not considered input repos. If there are any processes external to pachyderm that put data into input repos using any method (the Pachyderm APIs, <code>pachctl put file</code>, etc.), they need to be paused.<br> See <a href=#loading-data-from-other-sources-into-pachyderm>Loading data from other sources into pachyderm</a> below for design considerations for those processes that will minimize downtime during a restore or migration.</p> <p>Alternatively, you can use the following commands to stop all data loading into Pachyderm from outside processes.</p> <div class=codehilite><pre><span></span># Once you have stopped all running pachyderm pipelines, such as with this command,
# $ pachctl list pipeline --raw \
#   | jq -r &#39;.pipeline.name&#39; \
#   | xargs -P3 -n1 -I{} pachctl stop pipeline {}

# all pipelines in your cluster should be suspended. To stop all
# data loading processes, we&#39;re going to modify the pachd Kubernetes service so that
# it only accepts traffic on port 30649 (instead of the usual 30650). This way,
# any background users and services that send requests to your Pachyderm cluster
# while &#39;extract&#39; is running will not interfere with the process
#
# Backup the Pachyderm service spec, in case you need to restore it quickly
$ kubectl get svc/pach -o json &gt;pach_service_backup_30650.json

# Modify the service to accept traffic on port 30649
# Note that you&#39;ll likely also need to modify your cloud provider&#39;s firewall
# rules to allow traffic on this port
$ kubectl get svc/pachd -o json | sed &#39;s/30650/30649/g&#39; | kc apply -f -

# Modify your environment so that *you* can talk to pachd on this new port
$ pachctl config update context `pachctl config get active-context` --pachd-address=&lt;cluster ip&gt;:30649

# Make sure you can talk to pachd (if not, firewall rules are a common culprit)
$ pc version
COMPONENT           VERSION
pachctl             1.7.11
pachd               1.7.11
</pre></div> <h3 id=2-extract-a-pachyderm-backup-with-the-no-objects-flag>2. Extract a pachyderm backup with the --no-objects flag<a class=headerlink href=#2-extract-a-pachyderm-backup-with-the-no-objects-flag title="Permanent link">&para;</a></h3> <p>This step and the following step, <a href=#clone-your-object-store-bucket>3. Clone your object store bucket</a>, can be run simultaneously.</p> <p>Using the <code>pachctl extract</code> command, create the backup you need.</p> <p><code>pachctl extract --no-objects &gt; path/to/your/backup/file</code></p> <p>You can also use the <code>-u</code> or <code>--url</code> flag to put the backup directly into an object store.</p> <p><code>pachctl extract --no-objects --url s3://...</code></p> <p>Note that this s3 bucket is different than the s3 bucket will create to clone your object store. This is merely a bucket you allocated to hold the pachyderm backup without objects.</p> <h3 id=3-clone-your-object-store-bucket>3. Clone your object store bucket<a class=headerlink href=#3-clone-your-object-store-bucket title="Permanent link">&para;</a></h3> <p>This step and the prior step, <a href=#extract-a-pachyderm-backup-with-the-no-objects-flag>2. Extract a pachyderm backup with the --no-objects flag</a>, can be run simultaneously. Run the command that will clone a bucket in your object store.</p> <p>Below, we give an example using the Amazon Web Services CLI to clone one bucket to another, <a href=https://docs.aws.amazon.com/cli/latest/reference/s3/sync.html>taken from the documentation for that command</a>. Similar commands are available for <a href=https://cloud.google.com/storage/docs/gsutil/commands/cp>Google Cloud</a> and <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-use-azcopy-linux?toc=%2fazure%2fstorage%2ffiles%2ftoc.json">Azure blob storage</a>.</p> <p><code>aws s3 sync s3://mybucket s3://mybucket2</code></p> <h3 id=4-restart-all-pipeline-and-data-loading-ops>4. Restart all pipeline and data loading ops<a class=headerlink href=#4-restart-all-pipeline-and-data-loading-ops title="Permanent link">&para;</a></h3> <p>Once the backup and clone operations are complete, restart all paused pipelines and data loading operations, setting a checkpoint for the started operations that you can use in step <a href=#load-transactional-data-from-checkpoint-into-new-cluster>7. Load transactional data from checkpoint into new cluster</a>, below. See <a href=./backup_restore#loading-data-from-other-sources-into-pachyderm>Loading data from other sources into pachyderm</a> to understand why designing this checkpoint into your data loading systems is important.</p> <p>From the directed acyclic graphs (DAG) that define your pachyderm cluster, start each pipeline. You can either run a multiline shell command, shown below, or you must, for each pipeline, manually run the 'start pipeline' command.</p> <p><code>pachctl start pipeline &lt;pipeline-name&gt;</code></p> <p>You can confirm each pipeline is started using the <code>list pipeline</code> command</p> <p><code>pachctl list pipeline</code></p> <p>A useful shell script for running <code>start pipeline</code> on all pipelines is included below. It may be necessary to install several of the utlilies used in the script, like jq, on your system.</p> <div class=codehilite><pre><span></span>pachctl list pipeline --raw \
  | jq -r &#39;.pipeline.name&#39; \
  | xargs -P3 -n1 -I{} pachctl start pipeline {}
</pre></div> <p>If you used the port-changing technique, <a href=#pause-all-pipeline-and-data-loading-operations>above</a>, to stop all data loading into Pachyderm from outside processes, you should change the ports back.</p> <div class=codehilite><pre><span></span># Once you have restarted all running pachyderm pipelines, such as with this command,
# $ pachctl list pipeline --raw \
#   | jq -r &#39;.pipeline.name&#39; \
#   | xargs -P3 -n1 -I{} pachctl start pipeline {}

# all pipelines in your cluster should be restarted. To restart all data loading 
# processes, we&#39;re going to change the pachd Kubernetes service so that
# it only accepts traffic on port 30650 again (from 30649). 
#
# Backup the Pachyderm service spec, in case you need to restore it quickly
$ kubectl get svc/pach -o json &gt;pach_service_backup_30649.json

# Modify the service to accept traffic on port 30650, again
$ kubectl get svc/pachd -o json | sed &#39;s/30649/30650/g&#39; | kc apply -f -

# Modify your environment so that *you* can talk to pachd on the old port
$ pachctl config update context `pachctl config get active-context` --pachd-address=&lt;cluster ip&gt;:30650

# Make sure you can talk to pachd (if not, firewall rules are a common culprit)
$ pc version
COMPONENT           VERSION
pachctl             1.7.11
pachd               1.7.11
</pre></div> <p>Your old pachyderm cluster can operate while you're creating a migrated one. It's important that your data loading operations are designed to use the "<a href=./backup_restore#loading-data-from-other-sources-into-pachyderm>Loading data from other sources into pachyderm</a>" design criteria below for this to work.</p> <h3 id=5-deploy-a-1x-pachyderm-cluster-with-cloned-bucket>5. Deploy a 1.X Pachyderm cluster with cloned bucket<a class=headerlink href=#5-deploy-a-1x-pachyderm-cluster-with-cloned-bucket title="Permanent link">&para;</a></h3> <p>Create a pachyderm cluster using the bucket you cloned in <a href=#clone-your-object-store-bucket>3. Clone your object store bucket</a>. </p> <p>You'll want to bring up this new pachyderm cluster in a different namespace. You'll check at the steps below to see if there was some kind of problem with the extracted data and steps <a href=#extract-a-pachyderm-backup-with-the-no-objects-flag>2</a> and <a href=#clone-your-object-store-bucket>3</a> need to be run again. Once your new cluster is up and you're connected to it, go on to the next step.</p> <p>Note that there may be modifications needed to Kubernetes ingress to Pachyderm deployment in the new namespace to avoid port conflicts in the same cluster. Please consult with your Kubernetes administrator for information on avoiding ingress conflicts, or check with us in your Pachyderm support channel if you need help.</p> <p><em>Important: Use the</em> <code>kubectl config current-config</code> <em>command to confirm you're talking to the correct kubernetes cluster configuration for the new cluster.</em></p> <h3 id=6-restore-the-new-1x-pachyderm-cluster-from-your-backup>6. Restore the new 1.X Pachyderm cluster from your backup<a class=headerlink href=#6-restore-the-new-1x-pachyderm-cluster-from-your-backup title="Permanent link">&para;</a></h3> <p>Using the Pachyderm cluster you deployed in the previous step, <a href=#deploy-a-1.X-pachyderm-cluster-with-cloned-bucket>5. Deploy a 1.X pachyderm cluster with cloned bucket</a>, run <code>pachctl restore</code> with the backup you created in <a href=#extract-a-pachyderm-backup-with-the-no-objects-flag>2. Extract a pachyderm backup with the --no-objects flag</a>.</p> <div class="admonition note"> <p class=admonition-title>Important</p> <p>Use the_ <code>kubectl config current-config</code> <em>command to confirm you're talking to the correct kubernetes cluster configuration</em>.</p> </div> <p><code>pachctl restore &lt; path/to/your/backup/file</code></p> <p>You can also use the <code>-u</code> or <code>--url</code> flag to get the backup directly from the object store you placed it in</p> <p><code>pachctl restore --url s3://...</code></p> <p>Note that this s3 bucket is different than the s3 bucket you cloned, above. This is merely a bucket you allocated to hold the Pachyderm backup without objects.</p> <h3 id=7-load-transactional-data-from-checkpoint-into-new-cluster>7. Load transactional data from checkpoint into new cluster<a class=headerlink href=#7-load-transactional-data-from-checkpoint-into-new-cluster title="Permanent link">&para;</a></h3> <p>Configure an instance of your data loading systems to point at the new, upgraded pachyderm cluster and play back transactions from the checkpoint you established in <a href=#restart-all-pipeline-and-data-loading-operations>4. Restart all pipeline and data loading operations</a>. </p> <p>Perform any reconfiguration to data loading or unloading operations.</p> <p>Confirm that the data output is as expected and the new cluster is operating as expected.</p> <h3 id=8-disable-the-old-cluster>8. Disable the old cluster<a class=headerlink href=#8-disable-the-old-cluster title="Permanent link">&para;</a></h3> <p>Once you've confirmed that the new cluster is operating, you can disable the old cluster.</p> <h3 id=9-reconfigure-new-cluster-as-necessary>9. Reconfigure new cluster as necessary<a class=headerlink href=#9-reconfigure-new-cluster-as-necessary title="Permanent link">&para;</a></h3> <p>You may also need to reconfigure</p> <ul> <li>data loading operations from Pachyderm to processes outside of it to work as expected</li> <li>Kubernetes ingress and port changes taken to avoid conflicts with the old cluster</li> </ul> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../upgrades_migrations/ title=Overview class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> Overview </span> </div> </a> <a href=../upgrades/ title="Upgrade your Cluster" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Upgrade your Cluster </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright Pachyderm Inc, 2019 </div> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../assets/fonts/font-awesome.css> <a href=https://github.com/pachyderm/pachyderm class="md-footer-social__link fa fa-github-alt"></a> <a href=https://twitter.com/pachydermio class="md-footer-social__link fa fa-twitter"></a> <a href=https://www.linkedin.com/company/pachyderm-inc- class="md-footer-social__link fa fa-linkedin"></a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.cb24b6c0.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> </body> </html>